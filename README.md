Modified from 2014-present Simeon Velichkov's extension (MIT Liscenced)
